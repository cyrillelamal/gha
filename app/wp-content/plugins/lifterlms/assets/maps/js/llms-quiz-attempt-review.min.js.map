{"version":3,"file":"../../js/llms-quiz-attempt-review.min.js","sources":["llms-quiz-attempt-review.js"],"sourcesContent":[";/**\n * Quiz attempt review / grading UI & UX\n *\n * @since 3.16.0\n * @since 3.30.3 Unknown.\n * @version 5.3.0\n */( function( $ ) {\n\n\t/**\n\t * Handle UX for graving quiz attempts.\n\t *\n\t * @since 3.16.0\n\t * @since 3.30.3 Improve grading UX\n\t */\n\tvar Grading = function() {\n\n\t\t/**\n\t\t * Bind DOM events\n\t\t *\n\t\t * @since 3.16.0\n\t\t * @since 3.16.9 Unknown.\n\t\t * @return {Void}\n\t\t */\n\t\tfunction bind() {\n\n\t\t\t$( 'button[name=\"llms_quiz_attempt_action\"][value=\"llms_attempt_grade\"]' ).one( 'click', function( e ) {\n\n\t\t\t\te.preventDefault();\n\n\t\t\t\t$( this ).addClass( 'grading' );\n\n\t\t\t\tsetup_fields();\n\n\t\t\t} );\n\n\t\t}\n\n\t\t/**\n\t\t * Create editable fields for grading / remarking\n\t\t *\n\t\t * @since 3.16.0\n\t\t * @since 3.30.3 When starting a review only toggle first item if it's hidden and always automatically focus on the remarks field.\n\t\t * @since 5.3.0 Exclude removed question items.\n\t\t *\n\t\t * @return {Grading}\n\t\t */\n\t\tfunction setup_fields() {\n\n\t\t\t$els = $( '.llms-quiz-attempt-question:not(.type--content):not(.type--removed)' );\n\n\t\t\tif ( $els.length < 1 ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar title  = LLMS.l10n.translate( 'Remarks to Student' ),\n\t\t\t\tpoints = LLMS.l10n.translate( 'points' );\n\n\t\t\t$els.each( function() {\n\n\t\t\t\tvar id        = $( this ).attr( 'data-question-id' ),\n\t\t\t\t\t$existing = $( this ).find( '.llms-quiz-attempt-answer-section.llms-remarks' ),\n\t\t\t\t\t$ui       = $( '<div class=\"llms-quiz-attempt-answer-section llms-remarks\" />' ),\n\t\t\t\t\t$textarea = $( '<textarea class=\"llms-remarks-field\" name=\"remarks[' + id + ']\"></textarea>' )\n\t\t\t\t\tgradeable = ( 'yes' === $( this ).attr( 'data-grading-manual' ) );\n\n\t\t\t\t$ui.append( '<p class=\"llms-quiz-results-label remarks\">' + title + ':</p>' )\n\t\t\t\t$ui.append( $textarea );\n\t\t\t\tif ( gradeable ) {\n\t\t\t\t\tvar pts = $( this ).attr( 'data-points-curr' ),\n\t\t\t\t\t\tmax = $( this ).attr( 'data-points' );\n\t\t\t\t\t$ui.append( '<input name=\"points[' + id + ']\" max=\"' + max + '\" min=\"0\" type=\"number\" value=\"' + pts + '\"> / ' + max + ' ' + points );\n\t\t\t\t}\n\n\t\t\t\tif ( $existing.length ) {\n\n\t\t\t\t\t$textarea.text( $existing.find( '.llms-remarks' ).text() );\n\t\t\t\t\t$existing.replaceWith( $ui );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t$( this ).find( '.llms-quiz-attempt-question-main' ).append( $ui );\n\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t\tvar $els_first = $els.first();\n\t\t\tif ( ! $els_first.find( '.llms-quiz-attempt-question-main' ).is( ':visible' ) ) {\n\t\t\t\t// expand the first question toggle.\n\t\t\t\t$els_first.find( '.toggle-answer' ).trigger( 'click' );\n\t\t\t}\n\t\t\t// focus on its remark textarea.\n\t\t\t$els_first.find( '.llms-remarks-field' ).focus();\n\t\t}\n\n\t\tbind();\n\n\t\treturn this;\n\n\t};\n\n\twindow.llms         = window.llms || {};\n\twindow.llms.grading = new Grading();\n\n} )( jQuery );\n"],"names":["$","window","llms","grading","one","e","title","points","preventDefault","this","addClass","$els","length","LLMS","l10n","translate","each","pts","max","id","attr","$existing","find","$ui","$textarea","gradeable","append","text","replaceWith","$els_first","first","is","trigger","focus","jQuery"],"mappings":"CAMG,SAAYA,GA+FdC,OAAOC,KAAeD,OAAOC,MAAQ,GACrCD,OAAOC,KAAKC,QAAU,IAxFR,WAmFb,OAxECH,EAAG,uEAAwEI,IAAK,QAAS,SAAUC,GAqBpG,IAQKC,EACHC,EA5BAF,EAAEG,iBAEFR,EAAGS,MAAOC,SAAU,YAmBrBC,KAAOX,EAAG,wEAEAY,OAAS,IAIfN,EAASO,KAAKC,KAAKC,UAAW,sBACjCR,EAASM,KAAKC,KAAKC,UAAW,UAE/BJ,KAAKK,KAAM,WAEV,IASKC,EACHC,EAVEC,EAAYnB,EAAGS,MAAOW,KAAM,oBAC/BC,EAAYrB,EAAGS,MAAOa,KAAM,kDAC5BC,EAAYvB,EAAG,iEACfwB,EAAYxB,EAAG,sDAAwDmB,EAAK,kBAC5EM,UAAc,QAAUzB,EAAGS,MAAOW,KAAM,uBAEzCG,EAAIG,OAAQ,8CAAgDpB,EAAQ,SACpEiB,EAAIG,OAAQF,GACPC,YACAR,EAAMjB,EAAGS,MAAOW,KAAM,oBACzBF,EAAMlB,EAAGS,MAAOW,KAAM,eACvBG,EAAIG,OAAQ,uBAAyBP,EAAK,WAAaD,EAAM,kCAAoCD,EAAM,QAAUC,EAAM,IAAMX,IAGzHc,EAAUT,QAEdY,EAAUG,KAAMN,EAAUC,KAAM,iBAAkBK,QAClDN,EAAUO,YAAaL,IAIvBvB,EAAGS,MAAOa,KAAM,oCAAqCI,OAAQH,MAM3DM,EAAalB,KAAKmB,SACJR,KAAM,oCAAqCS,GAAI,aAEhEF,EAAWP,KAAM,kBAAmBU,QAAS,SAG9CH,EAAWP,KAAM,uBAAwBW,WAKnCxB,MA3FN,CAkGEyB","sourceRoot":"../../js"}